name: 'Main Branch PR Check'

on:
  pull_request:
    branches:
      - main  # 'main' 브랜치로 향하는 PR일 때만 실행

jobs:
  build-and-test:
    name: 'Build & Test'
    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [23.0]

    steps:
      # 1. 코드 체크아웃
      - name: 'Checkout code'
        uses: actions/checkout@v4

      # 2. Node.js 환경 설정
      - name: 'Use Node.js ${{ matrix.node-version }}'
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}
          cache: 'pnpm'
      
      # 3. 의존성 설치
      - name: 'Install dependencies'
        run: pnpm ci

      # 4. Lint 실행 (선택 사항이지만 강력히 권장)
      # package.json에 'lint' 스크립트가 정의되어 있어야 함
      - name: 'Run Lint'
        run: pnpm run lint

      # 5. Next.js 빌드 실행 (요청하신 핵심 빌드 체크)
      - name: 'Run Next.js Build'
        run: pnpm run build